<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Adriaan M. Dokter &amp; Peter Desmet" />


<title>Introduction to bioRad</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to bioRad</h1>
<h4 class="author">Adriaan M. Dokter &amp; Peter Desmet</h4>



<p>bioRad is an R package for the biological analysis and visualization
of weather radar data. The package is described in our paper:</p>
<blockquote>
<p>Dokter AM, Desmet P, Spaaks JH, Van Hoey S, Veen L, Verlinden L,
Nilsson C, Haase G, Leijnse H, Farnsworth A, Bouten W, Shamoun-Baranes S
(2019) bioRad: biological analysis and visualization of weather radar
data. Ecography 42: 852-860. <a href="https://doi.org/10.1111/ecog.04028" class="uri">https://doi.org/10.1111/ecog.04028</a></p>
</blockquote>
<p>The <a href="https://doi.org/10.1111/ecog.04028">paper</a> also
defines weather radar equivalents for familiar measures used in the
field of migration ecology and is thus a good start if you are new to
radar aeroecology. Below we included the sections and figure from the
paper describing the package and typical analysis workflow, with links
to the functions used.</p>
<p>In the top navigation, see <a href="https://adriaandokter.com/bioRad/reference/index.html"><strong>Reference</strong></a>
for an overview of all functions, <a href="https://adriaandokter.com/bioRad/articles/index.html"><strong>Articles</strong></a>
for course exercises and <a href="https://adriaandokter.com/bioRad/news/index.html"><strong>Changelog</strong></a>
for package updates.</p>
<!-- References used in this document -->
<div id="general-package-structure-and-functionality" class="section level2">
<h2>General package structure and functionality</h2>
<p>The functionality of bioRad is summarized in <a href="#figure-2">Fig.
2</a>. Essentially, the package allows users to:</p>
<ol style="list-style-type: decimal">
<li>Load, inspect and visualize low-level radar data (polar volume data,
also called level-II data in the US) of C-band or S-band weather radars,
formatted in either the European OPERA (ODIM hdf5) or US NEXRAD data
standard.</li>
<li>Extract biological information (speed, direction and density) at
different altitudes.</li>
<li>Visualize, aggregate, and summarize this biological information over
specific altitudes and time periods.</li>
</ol>
<p>In bioRad, class objects are used for storing low-level data and data
products, shown as blue/green boxes in <a href="#figure-2">Fig. 2</a>. R
has multiple class object systems, and bioRad uses the S3 object system
(<a href="https://www.routledge.com/Extending-R/Chambers/p/book/9781498775717">Chambers
2016</a>). Most of these class objects have an associated plot method
for making quick visualizations. The right-hand side of <a href="#figure-2">Fig. 2</a> shows examples of the output of these plot
methods, for two migration events of similar intensity, one in Europe
and one in the US. bioRad is able to extract vertical profiles of speed,
direction, and density at different flight altitudes from low-level
radar data, while offering standardized tools for post-processing and
further analysis. Spatial variation in the horizontal plane is averaged
out in profiles, and data is usually processed up to 25–35 km from the
radar. Vertical profiles are generated in bioRad with the <a href="https://github.com/adokter/vol2bird/">vol2bird algorithm</a>,
originally developed for single and dual-polarization C-band radars (<a href="https://doi.org/10.1098/rsif.2010.0116">Dokter et
al. 2011</a>).</p>
<p>The underlying C-code for the algorithm has been refactored for
compatibility with European and US radar formats, and for improved
structure and readability of the code base. Additional support has been
added for dual-polarization S-band radars, like the US WSR-88D/NEXRAD
radars, as well for dealiasing radial velocities. The package does not
yet support automated removal of precipitation signals for
single-polarization S-band radar. For these radars the generated
profiles should be manually screened for precipitation contamination
(cf. step 4 analysis workflow).</p>
</div>
<div id="figure-2" class="section level2">
<h2>Figure 2</h2>
<div class="figure">
<img src="data:text/html; charset=UTF-8;charset=utf-8,%3C%21DOCTYPE%20html%3E%3Chtml%20lang%3D%22en%2DUS%22%3E%3Chead%3E%3Ctitle%3EJust%20a%20moment%2E%2E%2E%3C%2Ftitle%3E%3Cmeta%20http%2Dequiv%3D%22Content%2DType%22%20content%3D%22text%2Fhtml%3B%20charset%3DUTF%2D8%22%3E%3Cmeta%20http%2Dequiv%3D%22X%2DUA%2DCompatible%22%20content%3D%22IE%3DEdge%22%3E%3Cmeta%20name%3D%22robots%22%20content%3D%22noindex%2Cnofollow%22%3E%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice%2Dwidth%2Cinitial%2Dscale%3D1%22%3E%3Clink%20href%3D%22%2Fcdn%2Dcgi%2Fstyles%2Fchallenges%2Ecss%22%20rel%3D%22stylesheet%22%3E%3Cmeta%20http%2Dequiv%3D%22refresh%22%20content%3D%2235%22%3E%3C%2Fhead%3E%3Cbody%20class%3D%22no%2Djs%22%3E%3Cdiv%20class%3D%22main%2Dwrapper%22%20role%3D%22main%22%3E%3Cdiv%20class%3D%22main%2Dcontent%22%3E%3Cnoscript%3E%3Cdiv%20id%3D%22challenge%2Derror%2Dtitle%22%3E%3Cdiv%20class%3D%22h2%22%3E%3Cspan%20class%3D%22icon%2Dwrapper%22%3E%3Cdiv%20class%3D%22heading%2Dicon%20warning%2Dicon%22%3E%3C%2Fdiv%3E%3C%2Fspan%3E%3Cspan%20id%3D%22challenge%2Derror%2Dtext%22%3EEnable%20JavaScript%20and%20cookies%20to%20continue%3C%2Fspan%3E%3C%2Fdiv%3E%3C%2Fdiv%3E%3C%2Fnoscript%3E%3C%2Fdiv%3E%3C%2Fdiv%3E%3Cscript%3E%28function%28%29%7Bwindow%2E%5Fcf%5Fchl%5Fopt%3D%7BcvId%3A%20%272%27%2CcZone%3A%20%27onlinelibrary%2Ewiley%2Ecom%27%2CcType%3A%20%27non%2Dinteractive%27%2CcNounce%3A%20%2731176%27%2CcRay%3A%20%27802722fcdb3b8ca1%27%2CcHash%3A%20%27e10dd9b376e2e55%27%2CcUPMDTk%3A%20%22%5C%2Fcms%5C%2Fasset%5C%2F5ffef211%2D85c6%2D4610%2D9d4c%2D0b7063e4b144%5C%2Fecog12354%2Dfig%2D0002%2Dm%2Ejpg%3F%5F%5Fcf%5Fchl%5Ftk%3DHvjz9Xc27n0KltU%2EQOdsGbgFd0IpJoVBZGtFPoyf0s0%2D1694007761%2D0%2DgaNycGzNCbs%22%2CcFPWv%3A%20%27g%27%2CcTTimeMs%3A%20%271000%27%2CcMTimeMs%3A%20%2760000%27%2CcTplV%3A%205%2CcTplB%3A%20%27cf%27%2CcK%3A%20%22visitor%2Dtime%22%2Cfa%3A%20%22%2Fcms%2Fasset%2F5ffef211%2D85c6%2D4610%2D9d4c%2D0b7063e4b144%2Fecog12354%2Dfig%2D0002%2Dm%2Ejpg%3F%5F%5Fcf%5Fchl%5Ff%5Ftk%3DHvjz9Xc27n0KltU%2EQOdsGbgFd0IpJoVBZGtFPoyf0s0%2D1694007761%2D0%2DgaNycGzNCbs%22%2Cmd%3A%20%22bdPea64aDA3qPKaWX2nDebukh7OkCLg0KOpczbht7tY%2D1694007761%2D0%2DARVy1l686zpMh%5FlOGya%5FoO3oGh7urylJiAiNqbeMDy8vHFwB4Dh9qMIRX2dsdaIvwyUxdttjmb4dUCyQG1sHjfeudrgm35F5ZCYAx2mEevXrsDNAJr0R5lklIuXXgm%5Fa774P2nvdOx4z5kn8L6KueQ1dBICAZYcz9K0SgVvJaMkuw3mFstV9jzH6ODakcLfgZxer2XEjm4JshIOEPcEdggMieBlnfpd1EpncWdTTu6HszBdU9LOy2zE%5FBeTNeMPFqHH1%5FalU%5FdlFebp%2DpA8LLR5ILZQW%2DxrwgTb8hDUDFfjCplJAYYqNQTBhWCjpBef0Jbeko6iAWGpKDGqJJIDTFcsH84DoCpvtqcfWjnQoVhPTy96s%2DbNtHmXU4BE9qx4W3jPR9jkDjN7MusTAKYn5ZRH5nWei6x5iCfz1oqQ5w5lvUrb8tUFuImZTfYKUrPhiW0rRTDFvh60z0oAb9LCFiY8fhoYXyBgtwe6DWsz4%2DsDZlzytADbPB7xcAux1qgiuVmnU%5FmErA58dAKtyAfEl%5F7K6s1YolK4k3hv%2Dnzk%2Dv146AX40nYU2gpOMvQMyJAee6KEhiKFhR%5FgedTSSFgRt35vcfAT6lIBBQjKxPdzWrEW6NM8MqAt36qWUxO4AXO4ddbMUHKwoYMjefVTSkGoIO9eD6Vi5uMdthkXkr9dCORTHfJzz27AcXumGcq8Ct1QbnbJRlk4fjbe9B3Ze2EeS2kayvEJLCXxcF2%5Fx%5FOWDz5mDkA0I%2DcJpjNgSUem%2D%2DUKFVFUMTR4SbjKtFe14pzxjTO98QJIr0DGQFfxLMuEtVTRoysk0J%5FxIxJswIuG0gLXg4M5uVP6EtW2nTMeiQkBIA9kQGsDvm5hik3XG0UQtxfyPoZgH2Frr%2Drs6pUWkmpZZtAUmcEp5ssENRMFvzmrn9YwIWlTX5TutxtZBeBIxisqgXFXEGbWg9%2D9V3%5FTue3E9RhKiwRxRiaY7NOkIJ%5FefQnWlrMhhSwq0dswbULCibMp9ZSgxWiBwmPXXtTtzzcd1UqCTfJ%5FAzVdSUnW6dbYlyd%5Fy6YFsK%2DKVw3To5vb6N8KwqDpl7JWh7Y7726RuTsaWnQEfwcgW%2D%2D8tHpcdwf0%5FdHgDakWrukjRn%5F1gSoRTmi0UyFAPZ%5FwvIMpwfJibLw0N1DKpT2HEZtRgzRpPNsf54RXaaHgrVJMhWWtIJD%5F6Ef%2D8UCFLND640hx1jrJzI%5Flgyk5a%2D5FSZkbgak3yi0PaMnaOVVVdoeVdsaN%5F43rxxHRXF8xkNxv3c7qcuNOaWi2WX8%5F7V9NArcXGOKEqXeRjoj2kg0Zz0zfbR4IMcAlLwE6Tke04jSqY%5FXTDRX0nGzhELvZy4DDO3nZGF7KNj%2D694OynnQ8ohUirJHbmFBIZhE0HvHiKYlmEy2EZ1SCyYEEp0A0pTFZ3LruktGKI5hZZDhAXpXzAJj07GXbIHJTZtc8DVSO%5F4Uz5mnS%5F171VdXYVg2TtvLInNUA8%5FmKkpdsvCj7akpfS3Q8%5FusSAq5K8KajtEO5uNPQAtxIO8DDMpLC17cFOYd6arDUXnt%5FfHMrXYGlRvX8Z%2DCFJ4tW8Iya4fslAEfR8go2MnMP6TRe99BxDF22eGshTSesMIujKdhf0siurJpyzg6t72MyILz3%2D7nPynnNwkaEEq3Gh6ZNsc2zNVgKnDW90YPDRUdZTJhuMrowqxknyiSsZRSk7J7B%5F0oCo0TWNoUKyoHd4eUWWQuTCvDEBELJ0bFKzqKwmIrvYyXtpZ93xSFIFUKBd8pMWdnWNSJ4GO6I1GS4GPBSN%5FpyrzFghfvjoshspr0I%2DiSIBvbz3uFp2EuNwMvoYcM55HvYUc0hJgP098HyNCl%5FN5GtQzqBt2RNyrgIojwn31rtXz0Hv%5FgG2OJqDJB2l27QHNsfIGfzxoPx4CzeiARhrssx0h6wwFi9z6FaqrL5peV7tfurvfWEGb2z1PU6JUbqQXxV93AfB4zPlDKdq7FXL51nrNDygzZ%5FOtxQE464hDmJhIHFOlXJgoU44Etj4rxTCzx7CMICuBAzs7h1ZDfyDRHcL056QSVso%2De1EN%5FanGDKTH20yyaTrwtC9y2TDXnm3BdZJHgQCcyshVRLV9ztE9ylLDJ85pg1S4fj%2DcCE6bpAfe2MJGTYyxbbSV4t%5FavkdZdMK6YODJnYXo1DbLi1lW2NyeLlJp7vjRlfI3QdNRrbIw177dbvRBqwOhU8AJcYz0sGw6yyqVHHcYstCFf44v%5FJGyNHbSM9qJOb%2DcyBJhhsyeD%2Dm9VrkuVYJVKg2RNyTPx8xj0%2DE4FPwAnwz5pKQBNlak%5FtDVz5AP4pKWUVFEHx2uTZg1Cm2ssiQBDntQsFNRqMfKtE0AELlny58baWeqzHBvsbNNJtp07N13OVV4RQpMCvXACrC4%5F04BkTUicgeV3A8aIGYlJdLHZiuIxjpf6XH4w%22%2CcRq%3A%20%7Bru%3A%20%27aHR0cHM6Ly9vbmxpbmVsaWJyYXJ5LndpbGV5LmNvbS9jbXMvYXNzZXQvNWZmZWYyMTEtODVjNi00NjEwLTlkNGMtMGI3MDYzZTRiMTQ0L2Vjb2cxMjM1NC1maWctMDAwMi1tLmpwZw%3D%3D%27%2Cra%3A%20%27Tk9fVUE%3D%27%2Crm%3A%20%27R0VU%27%2Cd%3A%20%2702Ywe8BXndlZAhvBggVvZ9WekWNIFGEAVR3ToaD8QzZk7WpEhV%2B6GwlOXYEuwY4MDCG8wYwsosiJoKi%2FROTFCe%2B%2B1851WS%2BwRY4vgfOMTS8dpwfJhQqBoitY2yWVOyOhfnvKUxR40I%2FQtLCuX8VG6nYhOYizIq%2Buaybo4hRd17bB7%2FJnab40pQYO7LIZmq7w4E2PrFjKzGNjwaQQX1c%2FAsNju%2BaltI3ubMhCdthHL8XllKHVWC3zA00uuN9ahCvWHkjR5zOqdiyZZMuXeDMcwb29Zog2QhzQ4JuhEoVxJ2IZ%2BNOwpF%2BQvd9BI4e%2BReIsXOlA8kxLNxR5xh9%2FoQPp2soG%2FR5o1b8hgDgM7ewyHHkijWAk%2BNgyf9PwPLktUlNNS0yRMkGmZZS%2BDYovErjMqZf3EPD27af1wDYtdrSAuxbPyfeV93ZGgSHD2qHHYjjQ3I4a5X6IgLXOVndQSLEgQb4VR%2BcHNZAbTjA3VGouCsNv%2FhBmHXZ6IXZJf%2BvgdKY61WvjDBN7kUc4mjzWjiHQ03BsefCgaSe0sst1Er3LvNk%3D%27%2Ct%3A%20%27MTY5NDAwNzc2MS40MzEwMDA%3D%27%2CcT%3A%20Math%2Efloor%28Date%2Enow%28%29%20%2F%201000%29%2Cm%3A%20%27VKCISHBK3%2FDO%2FzP7iDeBU7jNMwhML2SY4Auc0KL%2BH9A%3D%27%2Ci1%3A%20%27dOjhDa8maeOr5feyKXY6Gg%3D%3D%27%2Ci2%3A%20%272AuXMBSY%2FNRbnqa5YmgU7g%3D%3D%27%2Czh%3A%20%275psXVDyHKhylyDMHX58%2FNfMz0%2FwFqAsf4zTMPkqswgI%3D%27%2Cuh%3A%20%27DV4j3Tmrbi5Rs1q3ahwVS6SgbPbI7np5884QO1u1Cgg%3D%27%2Chh%3A%20%27EpAw8Lb%2FMscuVNQHjMk8adeJO9erYR0sl2%2FeKp5d934%3D%27%2C%7D%7D%3Bvar%20cpo%20%3D%20document%2EcreateElement%28%27script%27%29%3Bcpo%2Esrc%20%3D%20%27%2Fcdn%2Dcgi%2Fchallenge%2Dplatform%2Fh%2Fg%2Forchestrate%2Fchl%5Fpage%2Fv1%3Fray%3D802722fcdb3b8ca1%27%3Bwindow%2E%5Fcf%5Fchl%5Fopt%2EcOgUHash%20%3D%20location%2Ehash%20%3D%3D%3D%20%27%27%20%26%26%20location%2Ehref%2EindexOf%28%27%23%27%29%20%21%3D%3D%20%2D1%20%3F%20%27%23%27%20%3A%20location%2Ehash%3Bwindow%2E%5Fcf%5Fchl%5Fopt%2EcOgUQuery%20%3D%20location%2Esearch%20%3D%3D%3D%20%27%27%20%26%26%20location%2Ehref%2Eslice%280%2C%20location%2Ehref%2Elength%20%2D%20window%2E%5Fcf%5Fchl%5Fopt%2EcOgUHash%2Elength%29%2EindexOf%28%27%3F%27%29%20%21%3D%3D%20%2D1%20%3F%20%27%3F%27%20%3A%20location%2Esearch%3Bif%20%28window%2Ehistory%20%26%26%20window%2Ehistory%2EreplaceState%29%20%7Bvar%20ogU%20%3D%20location%2Epathname%20%2B%20window%2E%5Fcf%5Fchl%5Fopt%2EcOgUQuery%20%2B%20window%2E%5Fcf%5Fchl%5Fopt%2EcOgUHash%3Bhistory%2EreplaceState%28null%2C%20null%2C%20%22%5C%2Fcms%5C%2Fasset%5C%2F5ffef211%2D85c6%2D4610%2D9d4c%2D0b7063e4b144%5C%2Fecog12354%2Dfig%2D0002%2Dm%2Ejpg%3F%5F%5Fcf%5Fchl%5Frt%5Ftk%3DHvjz9Xc27n0KltU%2EQOdsGbgFd0IpJoVBZGtFPoyf0s0%2D1694007761%2D0%2DgaNycGzNCbs%22%20%2B%20window%2E%5Fcf%5Fchl%5Fopt%2EcOgUHash%29%3Bcpo%2Eonload%20%3D%20function%28%29%20%7Bhistory%2EreplaceState%28null%2C%20null%2C%20ogU%29%3B%7D%7Ddocument%2EgetElementsByTagName%28%27head%27%29%5B0%5D%2EappendChild%28cpo%29%3B%7D%28%29%29%3B%3C%2Fscript%3E%3C%2Fbody%3E%3C%2Fhtml%3E" alt />
<p class="caption"><strong>Figure 2 from <a href="https://doi.org/10.1111/ecog.04028">Dokter et
al. (2019)</a></strong></p>
</div>
<p>The figure shows the structure and interrelation of bioRad’s main
class objects, functions, and plotting methods. (A)
<strong>objects</strong> (rounded box), <strong>functions</strong>
(<code>fixed width font</code>) and their <strong>relation</strong>
(arrows). (B–K) output of the default plot methods for a European radar
(left row, Offenthal radar, Germany, 2016-10-04 15:15 UTC–2016-10-05
08:45 UTC) and US radar (right row, KBRO radar, Texas, 2017-05-14 00:09
UTC–2017-05-14 13:25 UTC). The dotted line in (H) and (K) indicates the
time slice of (B), (D), (F) and (C), (E), (J) respectively. Grey shading
indicates night time (time on the x-axis is in UTC). Altitudes are
relative to mean sea level.</p>
<ul>
<li>Figures (B) and (C) show radial velocity (VRADH) in m s<sup>–1</sup>
for the 1.5° elevation scans.</li>
<li>Figures (D) and (E) show reflectivity factor (DBZH) in dBZ for the
same scans.</li>
<li>Figures (F) and (G) shows animal density (<code>dens</code>) versus
altitude (RCS = 11 cm<sup>2</sup>) for a single vertical profile.</li>
<li>Figures (H) and (I) show animal density (<code>dens</code>) and
speed and direction (<code>dd</code> and <code>ff</code>) for a time
series of vertical profiles.</li>
<li>In figures (J) and (K), the black line shows MTR (migration traffic
rate across a transect perpendicular to ground speed direction), blue
line MTR<sub>0</sub> (migration traffic rate across a fixed east-to-west
transect) and red line MTR<sub>90</sub> (migration traffic rate across a
fixed north-to-south transect).</li>
</ul>
</div>
<div id="analysis-workflow" class="section level2">
<h2>Analysis workflow</h2>
<div id="step-1-loading-and-visualizing-radar-scans" class="section level3">
<h3>Step 1: loading and visualizing radar scans</h3>
<p>The low-level radar data with which bioRad interacts are so-called
<strong>polar volume data</strong>. A polar volume is a collection of
full-circle azimuthal scans (also referred to as sweeps) at various
elevations of the radar antenna, which together provide a sampling of
the atmosphere at all altitudes of interest. bioRad reads polar volumes
with the <code>read_pvolfile()</code> function, which returns the polar
volume as an object of class <code>pvol</code>. bioRad currently
supports HDF5 files (<a href="http://eumetnet.eu/wp-content/uploads/2017/01/OPERA_hdf_description_2014.pdf">Michelson
2014</a>) that are compliant with the European OPERA Data Information
Model (ODIM) (OPERA: Operational Program for Exchange of Weather Radar
Information; see <a href="https://doi.org/10.1175/BAMS-D-12-00216.1">Huuskonen et
al. 2014</a>), and level-2 data generated by the US Next Generation
Weather Radar (NEXRAD) network.</p>
<p>A polar volume (class <code>pvol</code>) contains a list of
<strong>scans</strong> (class <code>scan</code>), each of which consists
of a list of scan parameters (class <code>param</code>). A <strong>scan
parameter</strong> is one of the radar’s basic observed quantities, such
as reflectivity factor and radial velocity, and for dual-polarization
radars additional quantities such as correlation coefficient,
differential phase, and differential reflectivity.</p>
<p>Scan parameters can be projected on a georeferenced Cartesian grid in
the form of a <strong>plan position indicator</strong> (PPI) objects
(class <code>ppi</code>) using the function
<code>project_as_ppi()</code>. These can either be plotted directly
using the function <code>plot.ppi()</code> (<a href="#figure-2">Fig. 2B
and 2C</a>) or overlayed on a customizable basemap using the function
<code>map()</code> (<a href="#figure-2">Fig. 2D and 2E</a>), which makes
use of the <a href="https://ggplot2.tidyverse.org/">ggplot2</a> (<a href="https://doi.org/10.1007/978-0-387-98141-3">Wickham 2016</a>) and
<a href="https://github.com/dkahle/ggmap">ggmap</a> (<a href="https://journal.r-project.org/archive/2013/RJ-2013-014/index.html">Kahle
and Wickham 2013</a>) R libraries.</p>
</div>
<div id="step-2-processing-volumes-into-vertical-profiles" class="section level3">
<h3>Step 2: processing volumes into vertical profiles</h3>
<p>Polar volumes can be processed into vertical profiles of biological
targets using the <code>calculate_vp()</code> function, which is a
release of the algorithm vol2bird (<a href="https://doi.org/10.1098/rsif.2010.0116">Dokter et al. 2011</a>),
available independently on <a href="https://github.com/adokter/vol2bird">Github</a>. The function
takes in a polar volume file and outputs a vertical profile file and/or
a vertical profile (<code>vp</code>) class object. The function has an
argument <code>autoconf</code>, which when set to TRUE will select
default settings automatically (depending on radar wavelength and
availability of polarimetric data).</p>
<p>We describe the most important algorithm parameters and their
preferred settings:</p>
<ol style="list-style-type: decimal">
<li><code>range_min</code>, <code>range_max</code>: sets the minimum and
maximum range (distance from the radar) of data to include. We recommend
a minimum range of 5 km, to exclude the closest ranges that typically
contain a lot of ground clutter. We recommend a maximum range of 35 km,
which for most radars allows coverage up to 3 to 4 km a.s.l., which is
the altitude band in which most migration occurs (<a href="https://doi.org/10.1007/s10336-017-1506-z">Bruderer et
al. 2018</a>). At longer ranges, the radar beam gets very wide,
hampering the radar’s ability to resolve altitudinal distributions.</li>
<li><code>layers</code>, <code>layer_height</code>: sets the number of
altitude layers and their thickness, respectively. Altitudes are defined
relative to mean sea level, taking into account the antenna height as
stored in the original polar volume file. We recommend a thickness of
200 m. Profiles with narrower altitude bin spacings can be extracted (<a href="https://doi.org/10.1109/TGRS.2009.2014463">Buler and Diehl
2009</a>), but the finite size of the radar beam precludes resolving
altitudinal features smaller than approximately 100–200 m. Profile
quantities are estimated based on resolution samples centered within the
altitudinal spacing of each layer.</li>
<li><code>dual_pol</code>, <code>rho_hv</code>: the logical
<code>dual_pol</code> enables polarimetric filtering of precipitation,
which discards contiguous areas with correlation coefficient
(ρ<sub>HV</sub>) above a threshold <code>rho_hv</code>. We recommend
<code>rho_hv</code> = 0.95, since precipitation typically has higher
correlation coefficient values (<a href="https://doi.org/10.1002/ecs2.1539">Stepanian et al. 2016</a>) (but
note that lower ρ<sub>HV</sub> is possible in mixed precipitation, like
a combination of snow and rain, cf. <a href="https://doi.org/10.1175/1520-0450(1998)037%3C1228:DBRASW%3E2.0.CO;2">Ryzhkov
and Zrnic 1998</a>). Single polarization mode is currently only
available for C-band radars.</li>
<li><code>dealias</code>, <code>nyquist_min</code>: the logical
<code>dealias</code> enables radial velocity dealiasing following the
method by <a href="https://doi.org/10.1175/1520-0426(2004)021%3C1566:DODRVU%3E2.0.CO;2">Haase
and Landelius (2004)</a> when scans are present with a Nyquist velocity
smaller than threshold <code>nyquist_min</code> (default 25 m
s<sup>–1</sup>). The Nyquist velocity is stored in the
<code>attributes$how$NI</code> slot of scan class objects. Some radars
dealias velocities at acquisition time, e.g. using the dual-PRF
technique (<a href="https://doi.org/10.1175/JTECH1781.1">Holleman
2005</a>). For such radars we recommend no dealiasing for scans on which
this is applied. For data acquired with a single PRF we recommend
dealiasing when the Nyquist velocity of a scan is below 25 m
s<sup>–1</sup>, i.e. if there is a high probability that animal
movements will be faster than the Nyquist velocity.</li>
<li><code>sd_vvp_threshold</code>: animal speed and direction are
estimated using the Volume Velocity Profiling (VVP) technique (<a href="https://doi.org/10.1175/1520-0450(1979)018%3C0532:OTAOSD%3E2.0.CO;2">Waldteufel
and Corbin 1978</a>, <a href="https://doi.org/10.1175/JTECH1781.1">Holleman 2005</a>). VVP also
provides the standard deviation of the fit residuals (quantity
<code>sd_vvp</code> in a profile). The <code>sd_vvp_threshold</code>
parameter sets the threshold for discarding data based on this standard
deviation measure. Animal density will be set to zero in altitude layers
with a VVP standard deviation <code>sd_vvp</code> &lt;
<code>sd_vvp_threshold</code>. We recommend applying this thresholding
as a way of removing residual rain contaminations and insects in bird
studies using C-band radars, where <code>sd_vvp_threshold</code> = 2 m
s<sup>–1</sup> was shown a suitable value (<a href="https://doi.org/10.1098/rsif.2010.0116">Dokter et al. 2011</a>).
We note that <code>sd_vvp</code> may become large in relatively rare
cases where the velocity field is highly nonlinear (e.g. strong shear),
causing this thresholding criterion to break down. For S-band radars VVP
standard deviation thresholding has not been thoroughly evaluated, but
radial velocity variability during bird migration may be lower than at
C-band in certain cases. We currently recommend a conservative threshold
of 1 m s<sup>–1</sup> to retain more biological scatter.</li>
<li><code>rcs</code>: value for the radar cross section (RCS) of an
individual. We recommend 11 cm<sup>2</sup> as a starting point, which
was the seasonal average for C-band radars in western Europe during
nocturnal passerine migration, according to a calibration experiment (<a href="https://doi.org/10.1098/rsif.2010.0116">Dokter et al. 2011</a>).
Note that radar cross sections depend on target size, body orientation,
and radar wavelength (<a href="https://doi.org/10.1109/PROC.1985.13134">Vaughn 1985</a>).</li>
</ol>
<p>The <code>sd_vvp_threshold</code> and <code>rcs</code> parameters can
be changed using the <code>sd_vvp_threshold()</code> and
<code>rcs()</code> functions (in step 3 and up) without having to
reprocess the vertical profile (step 2).</p>
</div>
<div id="step-3-visualizing-and-interpreting-individual-profiles" class="section level3">
<h3>Step 3: visualizing and interpreting individual profiles</h3>
<p>The various quantities in a <strong>vertical profile</strong>
(e.g. <code>dens</code>: animal density, <code>ff</code>: ground speed,
<code>dd</code>: ground speed direction, <code>eta</code>: reflectivity)
can be visualized with <code>plot.vp()</code>, as shown in <a href="#figure-2">Fig. 2F and 2G</a> for density. These profile plots and
<a href="#figure-2">Fig. 2D and 2E</a> are for the same moment in time.
Note that both profiles show layering of birds: a density concentration
at high altitude (here at approx. 1.5 km) (cf. <a href="https://doi.org/10.1371/journal.pone.0052300">Dokter et
al. 2013</a>). These layers show up as concentric rings in <a href="#figure-2">Fig. 2D and 2E</a>. These rings appear because at an
increasing distance from the radar, measurements are made at higher
altitudes, because of the positive beam elevation and the curvature of
the earth.</p>
<p>Also note that the peak densities of the two cases are similar, on
the order of 100 individuals km<sup>–3</sup> (assuming RCS = 11
cm<sup>2</sup>) (<a href="#figure-2">Fig. 2H and 2I</a>). The
reflectivity factors (in dBZ scale, not to be confused with reflectivity
η (<a href="https://doi.org/10.1098/rsif.2010.0116">Dokter et
al. 2011</a>, <a href="https://doi.org/10.1890/ES12-00027.1">Chilson et
al. 2012b</a>) are however much higher for the US case than the European
case. This is related to the difference in radar wavelength (<a href="https://doi.org/10.1098/rsif.2010.0116">Dokter et al. 2011</a>),
with NEXRAD radars in the US being S-band and European radars being
mostly C-band.</p>
</div>
<div id="step-4-analyzing-and-visualizing-vertical-profiles-as-time-series" class="section level3">
<h3>Step 4: analyzing and visualizing vertical profiles as time
series</h3>
<p>After processing volume data into profiles, the profile data of
consecutive volume scans of a radar can be organized into a <strong>time
series of vertical profiles</strong>. The function
<code>bind_into_vpts()</code> binds vertical profile objects (class
<code>vp</code>) into time series object (class <code>vpts</code>), for
which the default plot is shown in <a href="#figure-2">figure 2H and
2I</a>. The dotted line indicates the time slice of <a href="#figure-2">Fig. 2B–G</a>.</p>
<p>The <code>plot.vpts()</code> method overlays one of the
reflectivity-based quantities (e.g. <code>dens</code>, <code>eta</code>
or <code>dbz</code>) with a barb indicating the animals ground speed and
direction. This follows meteorological conventions for graphically
displaying wind speed and direction (with north being up). The number of
barb flags indicate the speed (<code>ff</code>) while its tip points
into the direction where animals are moving (<code>dd</code>).</p>
<p>Another useful profile quantity to inspect as time series is DBZH.
This is the reflectivity factor for all scatterers, including
meteorological targets like precipitation. Time periods with rain are
often clearly visible as high DBZH values over the full altitude column.
We recommend making plots of DBZH as a way of screening for
precipitation contaminations and quality control, which is often a
useful way to check remarkable altitude patterns in the biological data
(e.g. the layering of birds at 1.5 km can also be seen in <a href="#figure-2">Fig. 2I</a>) or short spikes with high values that
might be due to rain contamination.</p>
<p>bioRad provides multiple functions to further aggregate and summarize
time series data. We can integrate over the altitude dimension using
<code>integrate_profile()</code>, which outputs a specially classed
<code>data.frame</code> (class <code>vpi</code>) containing
altitudinally integrated or averaged quantities. <a href="#figure-2">Figure 2J and 2K</a> show plots of migration traffic
rate, both MTR (variable transect angle, Eq. 1) and MTR<sub>0</sub> and
MTR<sub>90</sub> (fixed transect angle, Eq. 2). We note that MTR is
always positive, but MTR<sub>α</sub> definitions can become negative
depending on the migratory direction in relation to α. For example, the
northward spring migration (US case, <a href="#figure-2">Fig. 2K</a>)
result in a positive MTR<sub>0</sub>, while the southward autumn
migration (European case, <a href="#figure-2">Fig. 2J</a>) is negative.
For the US case, migration is directed mostly northward, therefore
MTR<sub>0</sub> is much larger than MTR<sub>90</sub>, while in the
European case, migration is mostly westward, therefore (in absolute
value) MTR<sub>0</sub> is smaller than MTR<sub>90</sub>.</p>
<p><strong>Vertically-integrated time series</strong> can be further
accumulated in time into measures summarizing migration traffic having
passed the radar station during a time period, like MT (migration
traffic) or RT (reflectivity traffic) (cf. output columns
<code>mt</code> and <code>rt</code> of
<code>integrate_profile()</code>). For example, for the European case we
find MT = 55 × 10<sup>3</sup>, MT<sub>0</sub> = –28 × 10<sup>3</sup> and
MT<sub>90</sub> = –45 × 10<sup>3</sup> for the time night-time period.
This means that – assuming a radar cross section (RCS) per individual of
11 cm<sup>2</sup> – 55 thousand birds per 1 km transect flew over the
radar station in this night (irrespective of direction). Decomposing the
migration traffic into two perpendicularly oriented components, we find
a net 28 thousand birds flew southward per km over a west-to-east
transect (MT<sub>0</sub>), and a net 45 thousand birds per km flew
westward per km over a north-to-south transect (MT<sub>90</sub>). For
these specific definitions, MT ≤ √(MT<sub>0</sub><sup>2</sup> +
MT<sub>90</sub><sup>2</sup>), with the left- and right-hand side being
equal when migration directions <code>dd</code> all point into a sector
of at most 180 degrees wide, as is usually the case for periods confined
to a single spring or fall.</p>
<p>Both the <code>vp</code> and <code>vpts</code> class objects can be
exported to standard R data frames (using
<code>as.data.frame.vp()</code> and <code>as.data.frame.vpts()</code>)
for further analysis outside of bioRad.</p>
</div>
</div>
<div id="example-datasets" class="section level2">
<h2>Example datasets</h2>
<p>bioRad includes a number of example datasets:</p>
<ul>
<li><p><code>bioRad::example_scan</code>: example object of class
<code>scan</code>.</p></li>
<li><p><code>bioRad::example_vp</code>: example object of class
<code>vp</code> as generated by <code>calculate_vp()</code>.</p></li>
<li><p><code>bioRad::example_vpts</code>: example object of class
<code>vpts</code>.</p></li>
<li><p><code>volume.h5</code>: example hdf5 file containing a polar
volume. Read using:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pvol_file <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;volume.h5&quot;</span>, <span class="at">package =</span> <span class="st">&quot;bioRad&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_pvolfile</span>(pvol_file)</span></code></pre></div></li>
<li><p><code>profile.h5</code>: example hdf5 file containing a vertical
profile generated by <code>calculate_vp()</code>. Read using:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>vp_file <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;profile.h5&quot;</span>, <span class="at">package =</span> <span class="st">&quot;bioRad&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_vpfiles</span>(vp_file)</span></code></pre></div></li>
<li><p><code>vpts.txt.zip</code>: example standard output of
<code>calculate_vp()</code> piped to a text file (and zipped). Read
using:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>vpts_file <span class="ot">&lt;-</span> utils<span class="sc">::</span><span class="fu">unzip</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;vpts.txt.zip&quot;</span>, <span class="at">package =</span> <span class="st">&quot;bioRad&quot;</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_vpts</span>(vpts_file, <span class="at">radar =</span> <span class="st">&quot;KBGM&quot;</span>, <span class="at">wavelength =</span> <span class="st">&quot;S&quot;</span>)</span></code></pre></div></li>
</ul>
<p>Conventions in data files:</p>
<ul>
<li><code>NA</code> maps to <code>nodata</code> in the ODIM convention:
value to denote areas void of data (never radiated).</li>
<li><code>NaN</code> maps to <code>undetect</code> in the ODIM
convention: denote areas below the measurement detection threshold
(radiated but nothing detected). The value is also used when there are
too few datapoints to calculate a quantity.</li>
<li><code>0</code> maps to <code>0</code> in the ODIM convention: denote
areas where the quantity has a measured value of zero (radiated and
value zero detected or inferred).</li>
</ul>
<p>It depends on a radar’s detection threshold or signal to noise ratio
whether it safe to assume an <code>undetect</code> is equivalent to
zero. When dealing with close range data only (within 35 km), it is
typically safe to assume aerial densities (dens) and reflectivities
(eta) are in fact zero in case of undetects.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
